"use strict";
(self["webpackChunkdenanu_login"] = self["webpackChunkdenanu_login"] || []).push([["components-register-Register-stories"],{

/***/ "./src/components/register/Register.stories.tsx":
/*!******************************************************!*\
  !*** ./src/components/register/Register.stories.tsx ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   __namedExportsOrder: () => (/* binding */ __namedExportsOrder),
/* harmony export */   banner: () => (/* binding */ banner),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _Register__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Register */ "./src/components/register/Register.tsx");


// Default metadata of the story https://storybook.js.org/docs/react/api/csf#default-export
const meta = {
  title: "Components/DenanuRegister",
  component: _Register__WEBPACK_IMPORTED_MODULE_0__["default"]
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (meta);

// The story type for the component https://storybook.js.org/docs/react/api/csf#named-story-exports

const banner = {
  args: {
    backendLocation: "http://localhost:8000"
  },
  argTypes: {
    backendLocation: {
      description: "Url of the sever backend"
    }
  }
};
banner.parameters = {
  ...banner.parameters,
  docs: {
    ...banner.parameters?.docs,
    source: {
      originalSource: "{\n  args: {\n    backendLocation: \"http://localhost:8000\"\n  },\n  argTypes: {\n    backendLocation: {\n      description: \"Url of the sever backend\"\n    }\n  }\n}",
      ...banner.parameters?.docs?.source
    }
  }
};
const __namedExportsOrder = ["banner"];

/***/ }),

/***/ "./src/components/api/Token.tsx":
/*!**************************************!*\
  !*** ./src/components/api/Token.tsx ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ useToken),
/* harmony export */   getValue: () => (/* binding */ getValue),
/* harmony export */   useLocalStorage: () => (/* binding */ useLocalStorage)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");

function getValue(key) {
  const str = localStorage.getItem(key);
  if (str) {
    const val = JSON.parse(str);
    return val;
  }
  return undefined;
}
function useLocalStorage(name) {
  const [value, setValue] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(getValue(name));
  const save = (userToken, remember) => {
    if (true) {
      if (userToken) {
        localStorage.setItem(name, JSON.stringify(userToken));
      } else {
        localStorage.removeItem(name);
      }
    }
    setValue(userToken);
  };
  return [value, save];
}
function useToken() {
  return useLocalStorage("token");
}
try {
    // @ts-ignore
    getValue.displayName = "getValue";
    // @ts-ignore
    getValue.__docgenInfo = { "description": "", "displayName": "getValue", "props": {} };
    // @ts-ignore
    if (typeof STORYBOOK_REACT_CLASSES !== "undefined")
        // @ts-ignore
        STORYBOOK_REACT_CLASSES["src/components/api/Token.tsx#getValue"] = { docgenInfo: getValue.__docgenInfo, name: "getValue", path: "src/components/api/Token.tsx#getValue" };
}
catch (__react_docgen_typescript_loader_error) { }
try {
    // @ts-ignore
    useLocalStorage.displayName = "useLocalStorage";
    // @ts-ignore
    useLocalStorage.__docgenInfo = { "description": "", "displayName": "useLocalStorage", "props": {} };
    // @ts-ignore
    if (typeof STORYBOOK_REACT_CLASSES !== "undefined")
        // @ts-ignore
        STORYBOOK_REACT_CLASSES["src/components/api/Token.tsx#useLocalStorage"] = { docgenInfo: useLocalStorage.__docgenInfo, name: "useLocalStorage", path: "src/components/api/Token.tsx#useLocalStorage" };
}
catch (__react_docgen_typescript_loader_error) { }

/***/ }),

/***/ "./src/components/api/register.tsx":
/*!*****************************************!*\
  !*** ./src/components/api/register.tsx ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   register: () => (/* binding */ register)
/* harmony export */ });
async function register(urlApi, handleError, onSuccess, setToken, username, mail, password, sendmail, remember, signature) {
  if (username && mail && password && sendmail && signature) {
    const data = await fetch(urlApi + "/register.php?" + new URLSearchParams({
      username: username,
      mail: mail,
      password: password,
      sendmail: sendmail,
      signature: signature
    })).then(r => r.json());
    if (data.status === "success") {
      setToken(data.data, Boolean(remember));
      onSuccess();
    } else if (data.status === "fail") {
      handleError(data.reason);
    }
  }
  handleError("error");
}

/***/ }),

/***/ "./src/components/register/Register.tsx":
/*!**********************************************!*\
  !*** ./src/components/register/Register.tsx ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ SignRegister)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");
/* harmony import */ var _api_Token__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../api/Token */ "./src/components/api/Token.tsx");
/* harmony import */ var _api_register__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../api/register */ "./src/components/api/register.tsx");



function SignRegister(props) {
  const {
    onLogIn,
    backendLocation
  } = props;
  const [, setToken] = (0,_api_Token__WEBPACK_IMPORTED_MODULE_1__["default"])();
  (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    const params = new URLSearchParams(window.location.pathname);
    (0,_api_register__WEBPACK_IMPORTED_MODULE_2__.register)(backendLocation, r => {}, () => {
      if (onLogIn) onLogIn;
    }, setToken, params.get("username"), params.get("mail"), params.get("password"), params.get("sendmail"), params.get("remember"), params.get("signature"));
  }, []);
  return null;
}
try {
    // @ts-ignore
    Register.displayName = "Register";
    // @ts-ignore
    Register.__docgenInfo = { "description": "", "displayName": "Register", "props": { "backendLocation": { "defaultValue": null, "description": "", "name": "backendLocation", "required": true, "type": { "name": "string" } }, "onLogIn": { "defaultValue": null, "description": "", "name": "onLogIn", "required": false, "type": { "name": "VoidFunction" } } } };
    // @ts-ignore
    if (typeof STORYBOOK_REACT_CLASSES !== "undefined")
        // @ts-ignore
        STORYBOOK_REACT_CLASSES["src/components/register/Register.tsx#Register"] = { docgenInfo: Register.__docgenInfo, name: "Register", path: "src/components/register/Register.tsx#Register" };
}
catch (__react_docgen_typescript_loader_error) { }

/***/ })

}]);
//# sourceMappingURL=components-register-Register-stories.iframe.bundle.js.map